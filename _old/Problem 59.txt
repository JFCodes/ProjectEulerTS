Module Module1

    Sub Main()
        Dim endTime As Double
        Dim resposta As Long = 0

        Dim reader As New System.IO.StreamReader("C:\Users\Joaquin\Dropbox\Project Euler\Sources\Problem 59.txt")
        Dim code_text() As String = Split(reader.ReadToEnd, ",")
        reader.Dispose()
        Dim starTime As Double = Timer

        Dim maxSpace As Short = 0


        For i = 97 To 122
            For j = 97 To 122
                For h = 97 To 122

                    Dim spaceCounter As Short = 0
                    Dim chart As String = ""
                    Dim ascNumber As Short = 0
                    Dim ascTotal As Integer = 0

                    For a = 0 To code_text.Length - 1
                        If a Mod 3 = 0 Then
                            ascNumber = code_text(a) Xor i
                            ascTotal += ascNumber
                            chart = Convert.ToString(Convert.ToChar(ascNumber))
                            If chart = " " Then spaceCounter += 1
                        ElseIf a Mod 3 = 1 Then
                            ascNumber = code_text(a) Xor j
                            ascTotal += ascNumber
                            chart = Convert.ToString(Convert.ToChar(ascNumber))
                            If chart = " " Then spaceCounter += 1
                        Else
                            ascNumber = code_text(a) Xor h
                            ascTotal += ascNumber
                            chart = Convert.ToString(Convert.ToChar(ascNumber))
                            If chart = " " Then spaceCounter += 1
                        End If
                    Next

                    If spaceCounter > maxSpace Then
                        resposta = ascTotal
                        maxSpace = spaceCounter
                    End If
                Next
            Next
        Next

        endTime = Timer
        Console.WriteLine("Resposta: " & resposta)
        Console.WriteLine("Excution time: " & endTime - starTime)
        Console.ReadKey()
    End Sub
End Module