Module Module1

    Sub Main()
        Dim endTime As Double
        Dim starTime As Double = Timer
        Dim resposta As Long = 0

        Dim stringNumber As String
        Dim counting As Integer
        For i = 1 To 1000
            stringNumber = GenerateTextNumber(i)

            counting = Replace(stringNumber, "_", "").Length
            resposta += counting
        Next

        endTime = Timer
        Console.WriteLine("Resposta: " & resposta)
        Console.WriteLine("Excution time: " & endTime - starTime)
        Console.ReadKey()
    End Sub

    Function GenerateTextNumber(number1 As Integer) As String
        Dim asText As String = ""
        Dim asString As String = number1.ToString

        Select Case asString.Length
            Case 1
                asText = getNumeric(number1.ToString(0))
            Case 2
                asText = getDecimal(asString(0)) & "_" & getNumeric(asString(1))
            Case 3
                asText = getNumeric(asString(0)) & "_hundred_and_" & getDecimal(asString(1)) & "_" & getNumeric(asString(2))
            Case 4
                asText = "one_thousand"
        End Select

        'Special Cases
        If InStr(asText, "ten_one") Then asText = Replace(asText, "ten_one", "eleven")
        If InStr(asText, "ten_two") Then asText = Replace(asText, "ten_two", "twelve")
        If InStr(asText, "ten_three") Then asText = Replace(asText, "ten_three", "thirteen")
        If InStr(asText, "ten_four") Then asText = Replace(asText, "ten_four", "fourteen")
        If InStr(asText, "ten_five") Then asText = Replace(asText, "ten_five", "fifteen")
        If InStr(asText, "ten_six") Then asText = Replace(asText, "ten_six", "sixteen")
        If InStr(asText, "ten_seven") Then asText = Replace(asText, "ten_seven", "seventeen")
        If InStr(asText, "ten_eight") Then asText = Replace(asText, "ten_eight", "eighteen")
        If InStr(asText, "ten_nine") Then asText = Replace(asText, "ten_nine", "nineteen")

        'Delete AND
        If number1 Mod 100 = 0 Then asText = Replace(asText, "and_", "")
        Return asText

    End Function

    Function getNumeric(number As String) As String
        Dim Text As String = ""
        Dim asNumber As Integer = CInt(number)

        Select Case number
            Case 0
                Text = ""
            Case 1
                Text = "one"
            Case 2
                Text = "two"
            Case 3
                Text = "three"
            Case 4
                Text = "four"
            Case 5
                Text = "five"
            Case 6
                Text = "six"
            Case 7
                Text = "seven"
            Case 8
                Text = "eight"
            Case 9
                Text = "nine"
        End Select

        Return Text
    End Function
    
    Function getDecimal(number As String) As String
        Dim Text As String = ""
        Dim asNumber As Integer = CInt(number)

        Select Case number
            Case 0
                Text = ""
            Case 1
                Text = "ten"
            Case 2
                Text = "twenty"
            Case 3
                Text = "thirty"
            Case 4
                Text = "forty"
            Case 5
                Text = "fifty"
            Case 6
                Text = "sixty"
            Case 7
                Text = "seventy"
            Case 8
                Text = "eighty"
            Case 9
                Text = "ninety"
        End Select

        Return Text
    End Function

End Module










using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Diagnostics;


namespace ConsoleApplication3
{
    class Program
    {
        static void Main(string[] args){

            int answer = 0;
            Stopwatch timer = new Stopwatch();
            timer.Start();

            string stringNumber = "";
            int counter = 0;

            for (int i = 1; i <= 1000; i++){
                stringNumber = GenerateTextNumber(i);

                counter = stringNumber.Replace("_", "").Length;
                answer += counter;
            }

            timer.Stop();
            Console.WriteLine("Answer: {0}", answer);
            Console.WriteLine("Processing time: {0}", timer.Elapsed);
            Console.ReadKey();
        }

        public static string GenerateTextNumber(int number){
            string text = "";
            string asString = Convert.ToString(number);

            switch (asString.Length){
                case 1:
                    text = getNumeric(char.ToString(asString[0]));
                    break;
                case 2:
                    text = getDecimal(char.ToString(asString[0])) + "_"
                        + getNumeric(char.ToString(asString[1]));
                    break;
                case 3:
                    text = getNumeric(char.ToString(asString[0])) + "_hundred_and_"
                        + getDecimal(char.ToString(asString[1])) + "_"
                        + getNumeric(char.ToString(asString[2]));
                    break;
                case 4:
                    text = "one_thousand";
                    break;
            }

            text = text.IndexOf("ten_one") == -1 ? text : text.Replace("ten_one", "eleven");
            text = text.IndexOf("ten_two") == -1 ? text : text.Replace("ten_two", "twelve");
            text = text.IndexOf("ten_three") == -1 ? text : text.Replace("ten_three", "thirteen");
            text = text.IndexOf("ten_four") == -1 ? text : text.Replace("ten_four", "fourteen");
            text = text.IndexOf("ten_five") == -1 ? text : text.Replace("ten_five", "fifteen");
            text = text.IndexOf("ten_six") == -1 ? text : text.Replace("ten_six", "sixteen");
            text = text.IndexOf("ten_seven") == -1 ? text : text.Replace("ten_seven", "seventeen");
            text = text.IndexOf("ten_eight") == -1 ? text : text.Replace("ten_eight", "eighteen");
            text = text.IndexOf("ten_nine") == -1 ? text : text.Replace("ten_nine", "nineteen");

            text = number % 100 != 0 ? text : text.Replace("and_", ""); 
            return text;
        }

        public static string getNumeric(string number)
        {
            string text = "";
            
            switch (number){
                case "0":
                    text = "";
                    break;
                case "1":
                    text = "one";
                    break;
                case "2":
                    text = "two";
                    break;
                case "3":
                    text = "three";
                    break;
                case "4":
                    text = "four";
                    break;
                case "5":
                    text = "five";
                    break;
                case "6":
                    text = "six";
                    break;
                case "7":
                    text = "seven";
                    break;
                case "8":
                    text = "eight";
                    break;
                case "9":
                    text = "nine";
                    break;
            }

            return text;
        }

        public static string getDecimal(string number)
        {
            string text = "";

            switch (number)
            {
                case "0":
                    text = "";
                    break;
                case "1":
                    text = "ten";
                    break;
                case "2":
                    text = "twenty";
                    break;
                case "3":
                    text = "thirty";
                    break;
                case "4":
                    text = "forty";
                    break;
                case "5":
                    text = "fifty";
                    break;
                case "6":
                    text = "sixty";
                    break;
                case "7":
                    text = "seventy";
                    break;
                case "8":
                    text = "eighty";
                    break;
                case "9":
                    text = "ninety";
                    break;
            }

            return text;
        }
    }
}
