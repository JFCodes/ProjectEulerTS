Module Module1

    Sub Main()
        Dim endTime As Double
        Dim starTime As Double = Timer
        Dim resposta As Integer = 0

        Dim number As Short = 0
        Dim maxValue As Short = 0

        For i = 1000 To 1 Step -1
            number = divisionCycleLength(i)
            If number > maxValue Then
                maxValue = number
                resposta = i
            End If
            If i < number Then Exit For
        Next

        endTime = Timer
        Console.WriteLine("Resposta: " & resposta)
        Console.WriteLine("Excution time: " & endTime - starTime)
        Console.ReadKey()
    End Sub

    Function divisionCycleLength(number As Integer) As Integer

        Dim remainder As Integer = 1
        Dim repeating(number) As Integer
        Dim lenght As Integer = 0

        Do While remainder > 0 And repeating(remainder) = 0
            repeating(remainder) = 1
            remainder = (remainder * 10) Mod number
            lenght += 1
        Loop

        If remainder = 0 Then Return 0 Else Return lenght
    End Function
End Module


using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Diagnostics;


namespace ConsoleApplication3
{
    class Program
    {
        static void Main(string[] args){

            int answer = 0;
            Stopwatch timer = new Stopwatch();
            timer.Start();

            int number = 0, maxValue = 0;

            for (int i = 1000; i > 1; i--){
                number = divisionCycleLength(i);
                
                if (number > maxValue){
                    maxValue = number;
                    answer = i;
                }

                if (i < number) break;
            }

            timer.Stop();
            Console.WriteLine("Answer: {0}", answer);
            Console.WriteLine("Processing time: {0}", timer.Elapsed);
            Console.ReadKey();
        }

        public static int divisionCycleLength(int number)
        {
            int remainder = 1;
            short length = 0;
            int[] repeating = new int[number];

            while (remainder > 0 && repeating[remainder] == 0)
            {
                repeating[remainder] = 1;
                remainder = (remainder * 10) % number;
                length++;
            }

            return remainder == 0 ? 0 : length;
        }
    }
}
