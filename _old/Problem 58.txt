Module Module1
    'Note: primesieve is not optimal in this problem.

    Sub Main()
        Dim endTime As Double
        Dim starTime As Double = Timer
        Dim resposta As Integer = 1

        Dim primeRatio As Double = 1
        Dim diagonalCounter As Integer = 1
        Dim primesCounter As Integer = 0

        Dim elementos As Integer = 0
        Dim lastnumber As Integer = 1

        Dim target1 As Integer = 0
        Dim target2 As Integer = 0
        Dim target3 As Integer = 0
        Dim target4 As Integer = 0

        Do While primeRatio > 0.1

            resposta += 1
            elementos = 8 * resposta - 8
            target1 = lastnumber + 2 * (resposta - 1)
            target2 = target1 + 2 * (resposta - 1)
            target3 = target2 + 2 * (resposta - 1)
            target4 = target3 + 2 * (resposta - 1)
            lastnumber = lastnumber + elementos

            primesCounter = primesCounter + isPrime(target1) + isPrime(target2) + isPrime(target3) + isPrime(target4)
            diagonalCounter += 4
            primeRatio = primesCounter / diagonalCounter
        Loop

        resposta = 2 * (resposta - 1) + 1

        endTime = Timer
        Console.WriteLine("Resposta: " & resposta)
        Console.WriteLine("Excution time: " & endTime - starTime)
        Console.ReadKey()
    End Sub

    Function isPrime(number As Integer) As Short

        For i = 3 To Math.Sqrt(number) Step 2
            If number Mod i = 0 Then Return 0
        Next
        Return 1
    End Function
End Module