Module Module1

    'Is proven that any hexagonal number is also triangular. S
    Sub Main()

        Dim endTime As Double
        Dim starTime As Double = Timer
        Dim answer As Integer = 0

        Dim sequence As String = ""
        Dim endCycle As Boolean
        Dim period As Short
        Dim index_a As Integer
        Dim index_d As Integer
        Dim index_m As Integer

        For square = 2 To 10000
            Dim collection As New List(Of String)
            endCycle = False
            period = 0

            index_m = 0
            index_d = 1
            index_a = Math.Floor(Math.Sqrt(square))

            If Math.Pow(index_a, 2) = square Then Continue For


            Do While endCycle = False
                index_m = index_d * index_a - index_m
                index_d = (square - (index_m * index_m)) / index_d
                index_a = Math.Floor((Math.Sqrt(square) + index_m) / index_d)

                If collection.Contains(index_m & "-" & index_d & "-" & index_a) Then Exit Do

                collection.Add(index_m & "-" & index_d & "-" & index_a)
                period += 1
            Loop

            If period Mod 2 = 1 Then answer += 1
        Next

        endTime = Timer
        Console.WriteLine("Answer: " & answer)
        Console.WriteLine("Excution time: " & endTime - starTime)
        Console.ReadKey()
    End Sub

End Module
